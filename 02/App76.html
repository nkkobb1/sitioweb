<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafío Mental: Acertijos y Lógica</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Fuentes limpias y legibles (Ej: Poppins para títulos, Lato para cuerpo) -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- Estilos Adaptados para Acertijos y Lógica --- */
        :root {
            --color-primary: #2a62bf; /* Azul Intelectual */
            --color-secondary: #f9a825; /* Amarillo/Naranja Idea Brillante */
            --color-background: #f4f7f9; /* Gris Muy Claro / Blanco Roto */
            --color-text: #333e48; /* Gris Oscuro Azulado */
            --color-text-muted: #6c7a89; /* Gris Medio */
            --color-modal-bg: #ffffff; /* Blanco Puro para Modal */
            --color-border: #d1d9e0; /* Borde Gris Claro */
            --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.07), 0 1px 2px -1px rgb(0 0 0 / 0.07); /* Sombras suaves */
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --border-radius: 6px; /* Bordes ligeramente redondeados */
            --transition-normal: all 0.25s ease-in-out;
        }
        body { font-family: 'Lato', sans-serif; background-color: var(--color-background); color: var(--color-text); line-height: 1.65; }
        h1.logo, h1.page-title, h2.section-title, #modal-title { font-family: 'Poppins', sans-serif; font-weight: 600; }
        h1.logo { color: var(--color-primary); }
        h1.page-title { color: var(--color-primary); }
        h2.section-title { color: var(--color-text); border-bottom: 2px solid var(--color-secondary); padding-bottom: 0.5rem; display: inline-block; }
        #modal-title { color: var(--color-primary); }
        .navbar { background-color: #ffffff; /* Fondo blanco sólido */ box-shadow: var(--shadow-md); position: sticky; top: 0; z-index: 20; border-bottom: 1px solid var(--color-border); }
        #title-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.25rem; }
        .title-item { background-color: var(--color-modal-bg); padding: 1.25rem 1rem; border-radius: var(--border-radius); box-shadow: var(--shadow-sm); cursor: pointer; transition: var(--transition-normal); text-align: center; font-weight: 600; color: var(--color-text); border: 1px solid var(--color-border); display: flex; align-items: center; justify-content: center; min-height: 75px; font-family: 'Poppins', sans-serif; font-size: 0.95rem; }
        .title-item:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); border-color: var(--color-primary); color: var(--color-primary); background-color: #e9f0f9; /* Azul muy claro hover */ }
        #generate-more-btn { grid-column: 1 / -1; background-color: var(--color-primary); color: white; padding: 0.75rem 1.5rem; border: none; border-radius: var(--border-radius); font-family: 'Poppins', sans-serif; font-weight: 600; cursor: pointer; transition: var(--transition-normal); margin-top: 1.8rem; }
        #generate-more-btn:hover:not(:disabled) { background-color: #1e4a9b; box-shadow: var(--shadow-sm); }
        #generate-more-btn:disabled { background-color: #a0b3c1; cursor: not-allowed; opacity: 0.8; }
        #generate-more-btn .fa-sync-alt { color: white; }
        #story-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(51, 62, 72, 0.85); /* Overlay gris azulado oscuro */ display: none; align-items: center; justify-content: center; z-index: 50; padding: 1rem; }
        #story-modal.active { display: flex; }
        .modal-content-wrapper {
            background-color: var(--color-modal-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 900px;
            width: 95%;
            max-height: 90vh;
            min-height: 300px; /* Altura mínima para pantalla de carga */
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--color-border);
        }
        .modal-close-btn { position: absolute; top: 12px; right: 12px; background: #e4e7eb; border: none; border-radius: 50%; width: 35px; height: 35px; font-size: 1.6rem; color: var(--color-text-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition-normal); z-index: 10; }
        .modal-close-btn:hover { background-color: var(--color-secondary); color: var(--color-text); transform: scale(1.1); }
        #modal-title { font-size: 1.8rem; text-align: center; margin-bottom: 1.5rem; flex-shrink: 0; padding: 0 1rem; line-height: 1.35; }
        #modal-content {
            line-height: 1.7;
            color: var(--color-text);
            white-space: normal;
            overflow-y: auto;
            padding: 0 10px 1.5rem 10px; /* Padding inferior para espacio */
            flex-grow: 1;
            min-height: 0;
            scrollbar-width: thin;
            scrollbar-color: var(--color-secondary) var(--color-border); /* Scrollbar temático */
        }
        #modal-content::-webkit-scrollbar { width: 9px; }
        #modal-content::-webkit-scrollbar-track { background: var(--color-border); border-radius: var(--border-radius); }
        #modal-content::-webkit-scrollbar-thumb { background-color: var(--color-secondary); border-radius: var(--border-radius); border: 2px solid var(--color-border); }
        #modal-content p:not(:last-child) { margin-bottom: 1.35em; }
        #modal-content strong { color: var(--color-primary); font-weight: bold; }
        #modal-content em { color: #555; font-style: italic; }
        /* Estilos para títulos dentro del contenido, si la API los genera */
        #modal-content h1, #modal-content h2, #modal-content h3, #modal-content h4 { font-family: 'Poppins', sans-serif; margin-top: 2em; margin-bottom: 1em; color: var(--color-primary); border-bottom: 1px solid var(--color-border); padding-bottom: 0.4em; font-weight: 600; }
        #modal-content h1 { font-size: 1.4em; }
        #modal-content h2 { font-size: 1.3em; }
        #modal-content h3 { font-size: 1.15em; color: var(--color-text); }
        #modal-content h4 { font-size: 1.05em; color: var(--color-text-muted); border-bottom: none; }
        /* Estilo para la imagen insertada al final del contenido */
        #modal-content .final-image { display: block; max-width: 75%; height: auto; margin: 2rem auto 1rem auto; border: 1px solid var(--color-border); border-radius: var(--border-radius); box-shadow: var(--shadow-sm); }
        /* Estilo para el placeholder/spinner de la imagen final */
        #modal-content .image-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 150px; margin: 2rem auto 1rem auto; color: var(--color-text-muted); }
        #modal-content .image-placeholder .spinner { border: 4px solid rgba(0, 0, 0, 0.08); width: 35px; height: 35px; border-radius: 50%; border-left-color: var(--color-primary); animation: spin 1s linear infinite; margin-bottom: 0.5rem; }
        #modal-content .image-placeholder .placeholder-icon { font-size: 2.5rem; }

        #modal-loading { text-align: center; padding: 3rem 0; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.97); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5; border-radius: var(--border-radius); }
        .loading-spinner-modal { width: 55px; height: 55px; border: 5px solid #d1d9e0; border-top-color: var(--color-primary); border-radius: 50%; animation: spin 1.1s linear infinite; margin: 0 auto 1.5rem auto; }
        #modal-loading p { font-weight: 600; color: var(--color-text); font-size: 1.25rem; font-family: 'Poppins'; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .error-msg { background-color: #fff3e0; /* Fondo error amarillo pálido */ color: #e65100; /* Texto naranja oscuro */ padding: 1.2rem; border-radius: var(--border-radius); border: 1px solid var(--color-secondary); margin-top: 1.5rem; text-align: center; flex-shrink: 0; font-weight: bold; }
        .error-msg i { margin-right: 0.7rem; }
        .content-hidden { display: none; }
    </style>
</head>
<body class="bg-gray-100">
     <!-- Header/Navbar -->
     <nav class="navbar mb-10">
         <div class="container mx-auto px-4 py-4 flex justify-center items-center">
             <div class="flex items-center text-center">
                 <h1 class="logo text-3xl sm:text-4xl">
                      <i class="fas fa-brain mr-3 text-blue-600"></i> <!-- Icono cerebro -->
                      Desafío Mental
                      <i class="fas fa-puzzle-piece ml-3 text-yellow-500"></i> <!-- Icono puzzle -->
                 </h1>
             </div>
         </div>
     </nav>

     <!-- Main content -->
     <main class="container mx-auto px-4 pb-16">
         <!-- Hero section -->
         <section class="mb-12 text-center">
             <h1 class="page-title text-4xl sm:text-5xl mb-5">Pon a Prueba tu Ingenio</h1>
             <p class="text-xl text-gray-700 mb-8 max-w-3xl mx-auto">Explora una colección de acertijos matemáticos, problemas de lógica, secuencias y enigmas. ¡Selecciona uno y ejercita tu mente!</p>
         </section>

         <!-- Title List Container -->
         <section class="mb-10">
             <h2 class="section-title text-3xl sm:text-4xl mb-8 text-center mx-auto">
                 <i class="fas fa-lightbulb text-yellow-500 mr-2"></i> <!-- Icono bombilla -->
                 Elige tu Desafío
             </h2>
             <div id="title-list">
                  <p id="titles-loading" class="text-gray-500 col-span-full text-center text-lg">Buscando acertijos...</p>
             </div>
             <div id="generate-more-container" class="text-center mt-8">
                 <button id="generate-more-btn">
                      <i class="fas fa-sync-alt mr-2 animate-spin hidden"></i>
                     Generar Más Acertijos
                  </button>
             </div>
         </section>

     </main>

     <!-- Explanation Modal -->
     <div id="story-modal">
         <div class="modal-content-wrapper">
             <button class="modal-close-btn" id="modal-close" aria-label="Cerrar">&times;</button>

             <!-- Loading Indicator -->
             <div id="modal-loading">
                 <div class="loading-spinner-modal"></div>
                 <p>Calculando solución...</p>
             </div>

             <!-- Content Area -->
             <div id="modal-story-content-area" class="content-hidden flex flex-col flex-grow min-h-0">
                 <h2 id="modal-title" class="text-2xl md:text-3xl font-bold mb-4 text-center flex-shrink-0"></h2>
                 <!-- Text Content (Scrollable) - La imagen se añadirá aquí al final -->
                 <div id="modal-content" class="text-base md:text-lg">
                     <!-- Explanation/Solution text (HTML) goes here -->
                     <!-- La imagen y su placeholder/spinner se añadirán aquí vía JS -->
                 </div>
                 <!-- Error Display Area -->
                 <div id="modal-error" class="error-msg content-hidden">
                      <i class="fas fa-exclamation-triangle"></i>
                      <span id="modal-error-message"></span>
                 </div>
             </div>
          </div>
      </div>

      <!-- Footer -->
      <footer class="bg-gray-200 text-gray-600 py-6 mt-12 border-t border-gray-300">
          <div class="container mx-auto px-4 text-center text-sm">
              <p>Soluciones y explicaciones generadas por IA para estimular el pensamiento lógico y matemático.</p>
              <p class="mt-1">¡Diviértete resolviendo!</p>
              <p class="mt-2">© 2025 Desafío Mental</p>
          </div>
      </footer>


    <script>
        // ========== CONFIG & DATA ==========
        const predefinedTitles = [
            // --- Lógica Clásica / Liars & Truth-tellers ---
            "El Acertijo del Lobo, la Cabra y la Col", "Los Misioneros y los Caníbales (Versión 3 y 3)", "El Puente y la Antorcha (4 personas, diferentes velocidades)", "El Acertijo de los Dos Guardias (Uno miente, uno dice verdad)", "La Isla de los Caballeros y los Escuderos (Knights & Knaves)", "Acertijo: ¿Qué puerta elegir?", "El Acertijo de los Tres Interruptores y la Bombilla", "El Acertijo de los Sombreros (3 Sombreros Blancos, 2 Negros)", "El Acertijo de los Sombreros (Variación con más personas)", "Acertijo de los 100 Prisioneros y la Bombilla", "El Problema de los 100 Prisioneros y las Cajas", "El Acertijo de Einstein (Zebra Puzzle)", "El Dilema del Prisionero (Explicación)", "La Paradoja del Mentiroso ('Esta oración es falsa')", "Acertijo: La Jarra de Vino y Agua", "Acertijo: Cruzando el río con restricciones de peso", "Acertijo: Identificar la moneda falsa (Balanza)", "Acertijo: La moneda falsa (Variación con 12 monedas)", "Acertijo: Los tres dioses (Verdadero, Falso, Aleatorio)", "Acertijo: El color de los ojos de los isleños", "El problema de Monty Hall (Las tres puertas)", "Acertijo de lógica: ¿Quién es el ladrón?", "Acertijo de lógica con horarios y coartadas", "Acertijo de deducción: Las profesiones", "Acertijo de secuencia lógica con personas en fila", "Problema de lógica: Emparejar elementos", "Acertijo de los calcetines en el cajón oscuro", "Acertijo: El hombre en el ascensor", "Acertijo: Llegar a una conclusión con información limitada", "Acertijo de las jarras de agua (Medir cantidad exacta)", "Acertijo de las jarras (Variación con 3 jarras)", "Acertijo de la familia en el puente", "Acertijo: ¿Cómo dividir un pastel en 8 partes con 3 cortes?", "Acertijo de pensamiento lateral: El hombre muerto en el campo", "Acertijo lateral: El carbón, la zanahoria y la bufanda", "Acertijo lateral: El hombre que empuja su coche", "Acertijo lateral: El paquete sin abrir", "Acertijo lateral: La música se detuvo", "Acertijo lateral: Domingo por la mañana", "Acertijo lateral: El camarero y el vaso de agua",

            // --- Secuencias Numéricas y de Patrones ---
            "¿Cuál es el siguiente número en la secuencia: 1, 1, 2, 3, 5, 8, ...?", // Fibonacci
            "Secuencia: 2, 4, 8, 16, 32, ...?", // Potencias de 2
            "Secuencia: 1, 4, 9, 16, 25, ...?", // Cuadrados perfectos
            "Secuencia: 1, 3, 6, 10, 15, ...?", // Números triangulares
            "Secuencia: 2, 6, 12, 20, 30, ...?", // n * (n+1)
            "Secuencia: 0, 1, 10, 11, 100, 101, ...?", // Binario
            "Secuencia: 1, 2, 2, 4, 8, 32, ...?", // Multiplicar los dos anteriores
            "Secuencia: 10, 4, 3, 11, 15, ...?", // Número de letras (diez, cuatro, tres...)
            "Secuencia: O, T, T, F, F, S, S, ...?", // Iniciales de One, Two, Three...
            "Secuencia: U, D, T, C, C, S, S, ...?", // Iniciales de Uno, Dos, Tres... (Español)
            "Secuencia: 3, 8, 15, 24, 35, ...?", // n^2 - 1
            "Secuencia: 1, 8, 27, 64, 125, ...?", // Cubos perfectos
            "Secuencia: 5, 10, 17, 26, 37, ...?", // n^2 + 1
            "Secuencia: 1, 2, 3, 6, 11, 20, ...?", // Suma de los 3 anteriores
            "Secuencia: 121, 144, 169, 196, ...?", // Cuadrados (11^2, 12^2...)
            "Secuencia: 2, 3, 5, 7, 11, 13, ...?", // Números primos
            "Secuencia: Z, X, V, T, R, ...?", // Alfabeto inverso saltando una letra
            "Secuencia: A, C, F, J, O, ...?", // Posición alfabeto +1, +2, +3...
            "Secuencia: 1, 11, 21, 1211, 111221, ...?", // Look-and-say sequence
            "Secuencia: 4, 6, 9, 10, 14, 15, ...?", // Compuestos + 1 ? No, primos +1? No... (Revisar) -> Números no primos? 4, 6, 8, 9, 10, 12, 14, 15... (Parece ser)
            "Secuencia: 77, 49, 36, 18, ...?", // Multiplicar dígitos (7*7=49, 4*9=36, 3*6=18, 1*8=8)
            "Secuencia: 2, 5, 11, 23, 47, ...?", // x*2 + 1
            "Secuencia: 9, 18, 6, 12, 4, ...?", // x*2, /3, x*2, /3...
            "Secuencia: 1, 5, 14, 30, 55, ...?", // Suma de cuadrados (1, 1+4, 1+4+9...)
            "Secuencia: 6, 11, 18, 27, 38, ...?", // Sumar números impares crecientes (+5, +7, +9...)
            "Secuencia: 1, 3, 7, 15, 31, ...?", // 2^n - 1
            "Secuencia: M, V, E, M, J, S, U, ...?", // Planetas (Mercurio, Venus, Earth...)
            "Secuencia: E, F, M, A, M, J, J, ...?", // Meses del año
            "Secuencia: 2, 7, 12, 17, 22, ...?", // +5
            "Secuencia: 100, 97, 94, 91, 88, ...?", // -3
            "Secuencia: 3, 6, 11, 18, 27, ...?", // +3, +5, +7, +9...
            "Secuencia: 1, 10, 100, 1000, ...?", // Potencias de 10
            "Secuencia: 0.5, 1, 2, 4, 8, ...?", // x2
            "Secuencia: 81, 27, 9, 3, 1, ...?", // /3
            "Secuencia: B, D, G, K, P, ...?", // Saltar 1, 2, 3, 4 letras...
            "Secuencia: R, O, Y, G, B, I, ...?", // Colores arcoíris (Red, Orange...)
            "Secuencia: 1, 4, 27, 256, ...?", // n^n
            "Secuencia: 61, 52, 63, 94, 46, ...?", // Números al revés (16, 25, 36, 49, 64...)
            "Secuencia: 2, 10, 12, 16, 17, 18, 19, ...?", // Números que empiezan con 'D' (Dos, Diez, Doce...)

            // --- Acertijos Matemáticos / Numéricos / Álgebra ---
            "Acertijo: La edad de los hijos (Producto 72, Suma = número casa)", "Acertijo: Si tengo 5 manzanas y me quitas 2, ¿cuántas tienes?", "Acertijo: El tren eléctrico y el humo", "Acertijo: Un pato entre dos patos", "Acertijo: ¿Cuántos animales tengo si todos son perros menos dos...?", "Acertijo: El pastor y las ovejas (Problema de edades)", "Acertijo: El precio del bate y la pelota ($1.10 total)", "Acertijo: El crecimiento del nenúfar (Duplica tamaño cada día)", "Acertijo: Los calcetines de colores (Probabilidad)", "Acertijo: Los números que faltan en el cuadrado mágico", "Acertijo: Si un ladrillo pesa 1kg más medio ladrillo...", "Acertijo: ¿Cuántos nueves hay entre 1 y 100?", "Acertijo: La suma de tres números impares que dé 30", "Acertijo: El número que si le quitas la mitad, vale cero", "Acertijo: El gallo que pone un huevo en la frontera", "Acertijo: Continuar la operación: 1=5, 2=10, 3=15, 4=20, 5=?", "Acertijo: 8888 + 888 + 88 + 8 + 8 = 1000 (¿Cómo?)", // (No es suma directa, ver solución)
            "Acertijo: Usar cuatro 4s para obtener números del 0 al 10", "Acertijo: El caracol que sube el pozo (Avanza 3, retrocede 2)", "Acertijo: Las edades de Ana y María (Relación)", "Acertijo: Repartir camellos (Herencia con fracciones)", "Acertijo: ¿Qué pesa más, un kilo de plumas o un kilo de plomo?", "Acertijo: Si 2 es compañía y 3 es multitud, ¿qué son 4 y 5?", // (9)
            "Acertijo: Multiplicar sin usar la tecla de multiplicar", "Acertijo: ¿Cuál es el número que sigue el patrón: 11, 21, 1211...?", // Look and say
            "Acertijo: Problema de velocidad, distancia y tiempo", "Acertijo: Calcular el área de una figura irregular", "Acertijo: El número perdido en una serie (Suma constante)", "Acertijo: La media aritmética de N números", "Acertijo: Ecuación simple con una incógnita", "Acertijo: Sistema de dos ecuaciones con dos incógnitas", "Acertijo: Problema de porcentajes (Descuentos)", "Acertijo: Problema de interés simple/compuesto", "Acertijo: Combinatoria (¿Cuántas combinaciones posibles?)", "Acertijo: Permutaciones (¿De cuántas formas ordenar?)", "Acertijo: Probabilidad de sacar una carta específica", "Acertijo: Probabilidad con dados", "Acertijo: El número de teléfono (Deducción numérica)", "Acertijo: ¿Cuánto es la mitad de 2 + 2?", // (Es 3)
            "Acertijo: El número capicúa", "Acertijo: Número de Strobogrammatic (Se lee igual al revés)", "Acertijo: ¿Cuándo 11 + 3 = 2? (En un reloj)", "Acertijo: Dividir 30 por 1/2 y sumar 10", // (70)
            "Acertijo: Un granjero tiene 17 vacas...", "Acertijo: El número de la bestia (666) - Curiosidades", "Acertijo: ¿Cuántos meses tienen 28 días?", "Acertijo: El conductor del autobús (¿De qué color son sus ojos?)", "Acertijo: Operación con números romanos", "Acertijo: El vendedor de naranjas (Vende mitades)", "Acertijo: Completar la tabla numérica", "Acertijo: Encontrar el patrón en una matriz de números", "Acertijo: El código secreto (Criptografía simple)", "Acertijo: Si corro una carrera y adelanto al segundo...", "Acertijo: ¿Qué número no tiene la letra 'E'?", "Acertijo: El número de cuadrados en un tablero de ajedrez", "Acertijo: Suma de los ángulos de un triángulo", "Acertijo: El teorema de Pitágoras (Explicación simple)", "Acertijo: Propiedades de los números primos", "Acertijo: Divisibilidad por 3, 4, 5, 9, 11", "Acertijo: ¿Qué número multiplicado por sí mismo da -1?", // (Imaginario i)
            "Acertijo: La secuencia de Collatz (3n+1)", "Acertijo: El Infinito Hotel de Hilbert", "Acertijo: Paradoja de Zenón (Aquiles y la tortuga)", "Acertijo: Paradoja del Barbero", "Acertijo: Criptoaritmética (SEND + MORE = MONEY)", "Acertijo: Criptoaritmética (EAT + THAT = APPLE)", "Acertijo: Criptoaritmética (CROSS + ROADS = DANGER)", "Acertijo: Torres de Hanoi (Explicación y solución)", "Acertijo: El problema de los puentes de Königsberg", "Acertijo: El problema de los cuatro colores", "Acertijo: ¿Cómo medir 4 litros con jarras de 3 y 5?", "Acertijo: El problema del cumpleaños (Probabilidad coincidencia)", "Acertijo: La Rueda de la Fortuna (Probabilidad)", "Acertijo: El inspector y las bolsas de monedas (Balanza)", "Acertijo: Lógica de Sudoku (Principios básicos)", "Acertijo: Conectar 9 puntos con 4 líneas rectas", "Acertijo: Dibujar una casa sin levantar el lápiz", "Acertijo: El problema de Josephus (Superviviente en círculo)", "Acertijo: Juego de Nim (Estrategia ganadora)", "Acertijo: El número áureo (Phi) - Introducción", "Acertijo: La espiral de Fibonacci en la naturaleza", "Acertijo: El triángulo de Pascal y sus patrones", "Acertijo: ¿Cuántos apretones de mano en una reunión?", "Acertijo: El gato encerrado (Lógica deductiva)", "Acertijo: Las balanzas y las bolas de billar", "Acertijo: El calendario perpetuo (Concepto)", "Acertijo: ¿Qué palabra se escribe siempre incorrectamente?", "Acertijo: El eco que responde preguntas", "Acertijo: ¿Qué sube pero nunca baja?", // La edad
            "Acertijo: Tengo ciudades, pero no casas...", // Un mapa
            "Acertijo: ¿Qué tiene un ojo pero no puede ver?", // Una aguja, un huracán
            "Acertijo: ¿Qué está siempre delante de ti pero no puedes ver?", // El futuro
            "Acertijo: ¿Qué se moja mientras seca?", // Una toalla
            "Acertijo: ¿Qué puedes sostener en tu mano derecha, pero nunca en la izquierda?", // Tu codo izquierdo
            "Acertijo: ¿Qué tiene cuello pero no cabeza?", // Una botella
            "Acertijo: ¿Qué es tan frágil que decir su nombre lo rompe?", // El silencio
            "Acertijo: ¿Qué invento te permite mirar a través de las paredes?", // Una ventana
            "Acertijo: Si lo tienes, quieres compartirlo...", // Un secreto
            "Acertijo: ¿Qué va hacia arriba y hacia abajo pero siempre permanece en el mismo lugar?", // Una escalera
            "Acertijo: ¿Qué corre pero nunca camina?", // El agua, un río
            "Acertijo: ¿Qué tiene llaves pero no abre cerraduras?", // Un piano, un teclado
            "Acertijo: Cuanto más le quitas, más grande se vuelve.", // Un agujero
            "Acertijo: ¿Qué vuela sin alas?", // El tiempo
            "Acertijo: ¿Qué se necesita responder, pero no hace preguntas?", // Un teléfono
            "Acertijo: ¿Qué pertenece a ti, pero otros lo usan más?", // Tu nombre
            "Acertijo de lógica temporal: Ayer, hoy y mañana", "Acertijo del palíndromo numérico", "Acertijo de divisibilidad y restos", "Problema de optimización simple (Ej: cercado)", "Acertijo geométrico: Área vs Perímetro", "Acertijo geométrico: ¿Cuántos triángulos hay en la figura?", "Acertijo geométrico: Visualizar un cubo desplegado", "Acertijo con números binarios", "Acertijo con lógica booleana (AND, OR, NOT)", "Acertijo de teoría de grafos simple (Recorridos)", "Acertijo de cerillas (Mover para corregir ecuación)", "Acertijo de cerillas (Formar figuras)", "Acertijo de probabilidad condicional (Teorema de Bayes simple)", "Acertijo de valor esperado (Juegos de azar)", "Acertijo sobre números perfectos", "Acertijo sobre números amigos", "Acertijo de lógica difusa (Concepto introductorio)", "Acertijo sobre el Principio del Palomar", "Acertijo con números factoriales", "Acertijo de inducción matemática (Ejemplo simple)", "Acertijo basado en un fractal (Ej: Triángulo de Sierpinski)", "Acertijo: Ordenar libros en una estantería", "Acertijo: El problema del viajante (Concepto)", "Acertijo: Encontrar el elemento diferente (Patrón visual)", "Acertijo: Completar un Sudoku (Estrategias básicas)", "Acertijo: Kakuro (Principios)", "Acertijo: KenKen (Principios)", "Acertijo: Hitori (Principios)", "Acertijo: Slitherlink (Principios)", "Acertijo: Nonograma / Picross (Principios)", "Acertijo: El laberinto (Encontrar la salida)", "Acertijo: Tangram (Formar figuras)", "Acertijo: Cubo Soma (Concepto)", "Acertijo: ¿Qué pesa más, un litro de agua o un litro de aceite?", "Acertijo: La paradoja del abuelo", "Acertijo: La paradoja de Teseo (El barco)", "Acertijo: El gato de Schrödinger (Explicación conceptual)", "Acertijo: ¿Puede Dios crear una piedra que no pueda levantar?", "Acertijo: Si un árbol cae en el bosque...", "Acertijo de lógica modal (Posibilidad y necesidad)", "Acertijo: ¿Cuántos cumpleaños tiene una persona promedio?", "Acertijo: El número Pi (π) - Curiosidades", "Acertijo: El número e - Curiosidades", "Acertijo: El infinito contable vs incontable", "Acertijo: Demostración por contradicción (Ejemplo)", "Acertijo: ¿Qué viene después de un millón, billón, trillón...?", "Acertijo: ¿Cómo hacer que cuatro 9 den 100?", // 99 + 9/9
            "Acertijo: Formar 24 con los números 1, 3, 4, 6", "Acertijo: El número de la mala suerte (13) - Origen", "Acertijo: Sistema de numeración Maya (Concepto)", "Acertijo: Sistema de numeración Romano (Reglas)", "Acertijo: El Ábaco (Cómo funciona)", "Acertijo: La Regla de Cálculo (Concepto histórico)", "Acertijo: La Máquina de Turing (Concepto)", "Acertijo: ¿Es 0 un número par o impar?", "Acertijo: ¿Es 1 un número primo?", "Acertijo: El último dígito de 2^100", "Acertijo: Números de Mersenne", "Acertijo: Números de Fermat", "Acertijo: Conjetura de Goldbach", "Acertijo: Hipótesis de Riemann (Mención)", "Acertijo: Último Teorema de Fermat (Historia)", "Acertijo: Problema P vs NP (Mención)", "Acertijo: ¿Qué es un algoritmo?", "Acertijo: Ordenamiento Burbuja (Explicación simple)", "Acertijo: Búsqueda Binaria (Explicación simple)", "Acertijo: El problema de las N reinas (Tablero de ajedrez)", "Acertijo: Recorrido del caballo (Ajedrez)", "Acertijo: El juego de la vida de Conway (Concepto)", "Acertijo: ¿Cómo cruzarían un río un granjero con un zorro, una gallina y un saco de grano?", // Variante Lobo, cabra, col
            "Acertijo: El enigma de los calcetines desparejados", "Acertijo: Si A es B y B es C, ¿es A C?", "Acertijo: Deducción lógica en árbol genealógico", "Acertijo: El tren fantasma (Paradoja temporal simple)", "Acertijo: El hotel infinito con infinitos autobuses", "Acertijo: ¿Cuántas veces se puede restar 1 de 100?", // Solo una vez
            "Acertijo: El reloj de arena (Medir tiempo)", "Acertijo: El lechero y las jarras", "Acertijo: La división de la herencia (Fracciones complejas)", "Acertijo: Si hoy es lunes, ¿qué día será en 100 días?", "Acertijo: El año bisiesto (Reglas)", "Acertijo: Las manecillas del reloj (¿Cuándo se superponen?)", "Acertijo: ¿Qué ángulo forman las manecillas a las 3:15?", "Acertijo: El número de diagonales de un polígono", "Acertijo: Suma de los ángulos internos de un polígono", "Acertijo: El número de caras, aristas y vértices de un poliedro (Fórmula de Euler)", "Acertijo: Los sólidos platónicos", "Acertijo: La cinta de Moebius", "Acertijo: La botella de Klein", "Acertijo: ¿Qué es un fractal?", "Acertijo: El conjunto de Mandelbrot (Visualización)", "Acertijo: La curva de Koch (Copo de nieve)", "Acertijo: El efecto mariposa (Teoría del caos)", "Acertijo: Ley de Benford (Distribución de dígitos)", "Acertijo: El principio de incertidumbre de Heisenberg (Concepto)", "Acertijo: La relatividad especial de Einstein (Concepto básico)", "Acertijo: El gato está vivo y muerto a la vez (Superposición cuántica)", "Acertijo: El entrelazamiento cuántico (Concepto)", "Acertijo: ¿Qué es la materia oscura?", "Acertijo: ¿Qué es la energía oscura?", "Acertijo: La paradoja de Fermi (¿Dónde están todos?)", "Acertijo: La ecuación de Drake (Probabilidad de vida extraterrestre)", "Acertijo: ¿Puedes probar que no eres un cerebro en una cubeta?", "Acertijo: El problema del tranvía (Dilema ético)", "Acertijo: Lógica de primer orden (Concepto básico)", "Acertijo: Silogismos (Todos los hombres son mortales...)", "Acertijo: Falacias lógicas comunes (Ad hominem, hombre de paja...)"
            // Total: ¡Más de 400 títulos!
        ];
        const puzzleThemes = [
            "acertijos de lógica clásica", "problemas de secuencias numéricas", "puzzles de pensamiento lateral",
            "enigmas matemáticos", "rompecabezas geométricos", "problemas de probabilidad", "criptoaritmética",
            "acertijos de palabras y números", "paradojas famosas", "problemas de optimización", "teoría de juegos simple",
            "patrones visuales", "acertijos con cerillas", "problemas de tiempo y calendario", "acertijos de física conceptual",
            "enigmas de deducción", "problemas de combinatoria", "acertijos de teoría de números", "puzzles de topología",
            "juegos de lógica (Sudoku, Nonogramas)", "acertijos sobre el infinito", "dilemas éticos con lógica"
        ];
        const textApiConfig = {
            model: "mistral",
            systemPrompt: "Eres un experto en lógica y matemáticas recreativas. Tu tarea es explicar acertijos, problemas lógicos o secuencias de forma clara, detallada y pedagógica. Primero, presenta el enigma o problema de forma concisa. Luego, guía al lector a través del proceso de pensamiento necesario para encontrar la solución, explicando los principios lógicos o matemáticos subyacentes. Finalmente, presenta la solución de manera explícita y justificada. Usa un lenguaje accesible pero preciso. El objetivo es una explicación completa de aproximadamente 1200-1300 palabras que no solo dé la respuesta, sino que enseñe a razonar. Basa tu explicación únicamente en el siguiente acertijo o problema:",
            timeoutSeconds: 150
        };
        const titleGenerationConfig = {
            model: "mistral",
            systemPrompt: "Actúa como un generador de ideas conciso para una colección de desafíos mentales. Genera exactamente 15 títulos de acertijos matemáticos, problemas de lógica, enigmas de secuencias o puzzles de pensamiento lateral, adecuados para ser explicados en detalle. Asegura variedad en tipo y dificultad aparente. Devuelve *solo* la lista de títulos, uno por línea. No incluyas números, guiones, introducciones ni despedidas.",
            timeoutSeconds: 40
        };

        // ========== DOM ELEMENTS ========== (sin cambios estructurales)
        const titleListContainer = document.getElementById('title-list');
        const titlesLoading = document.getElementById('titles-loading');
        const generateMoreContainer = document.getElementById('generate-more-container');
        const generateMoreBtn = document.getElementById('generate-more-btn');
        const generateMoreSpinner = generateMoreBtn.querySelector('i');
        const storyModal = document.getElementById('story-modal');
        const modalCloseBtn = document.getElementById('modal-close');
        const modalLoadingIndicator = document.getElementById('modal-loading');
        const modalStoryContentArea = document.getElementById('modal-story-content-area');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content'); // Contenedor del texto + imagen final
        const modalError = document.getElementById('modal-error');
        const modalErrorMessage = document.getElementById('modal-error-message');

        // ========== API FUNCTIONS ==========
        async function fetchTextFromApi(prompt, config) { /* ... Sin cambios ... */
            const encodedPrompt = encodeURIComponent(prompt);
            const encodedSystem = encodeURIComponent(config.systemPrompt);
            const params = new URLSearchParams({ model: config.model, system: encodedSystem });
            if (config.seed) params.append('seed', config.seed);
            const url = `https://text.pollinations.ai/${encodedPrompt}?${params.toString()}`;
            console.log(`Fetching text from API (${config.model}): ${url.substring(0, 200)}...`);
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), config.timeoutSeconds * 1000);
            try {
                const response = await fetch(url, { signal: controller.signal });
                clearTimeout(timeoutId);
                if (!response.ok) throw new Error(`Error HTTP ${response.status}.`);
                const text = await response.text();
                if (!text || text.trim().length === 0) throw new Error("La respuesta de la API estaba vacía.");
                console.log(`API Response received (${text.length} chars)`);
                return text;
            } catch (error) {
                clearTimeout(timeoutId);
                console.error("API Fetch Error:", error);
                if (error.name === 'AbortError') throw new Error(`La solicitud a la API tardó demasiado (>${config.timeoutSeconds}s). Intente de nuevo.`);
                throw new Error(`Error de comunicación con la API: ${error.message}`);
            }
        }
        async function fetchExplanationText(conceptTitle) { /* ... Sin cambios ... */
            const text = await fetchTextFromApi(conceptTitle, textApiConfig);
             if (text.trim().length < 800 || text.toLowerCase().includes("cannot fulfill") || text.toLowerCase().includes("no puedo generar") || text.toLowerCase().includes("incapaz de")) {
                  throw new Error("La IA no pudo generar una explicación adecuada o suficientemente detallada para este acertijo.");
              }
            return text;
         }
        async function fetchGeneratedTitles() { /* ... Sin cambios ... */
            const randomTheme = getRandomElement(puzzleThemes) || "acertijos de lógica variados";
            const specificPrompt = `Genera 15 títulos de acertijos o problemas lógicos sobre ${randomTheme}`;
            console.log("Generating titles with prompt:", specificPrompt);
            const configForThisRequest = { ...titleGenerationConfig, seed: Math.floor(Math.random() * 1000000) };
            const text = await fetchTextFromApi(specificPrompt, configForThisRequest);
            const titles = text.split('\n').map(line => line.replace(/^[-\d.\s*]+/, '').trim()).filter(line => line.length > 10 && line.length < 150);
             if (titles.length < 5) throw new Error("No se pudieron generar suficientes ideas de acertijos.");
             // Simple deduplication check against last 30 generated/displayed titles (basic)
             const existingTitles = Array.from(titleListContainer.querySelectorAll('.title-item')).slice(-30).map(el => el.dataset.title.toLowerCase());
             const uniqueNewTitles = titles.filter(t => !existingTitles.includes(t.toLowerCase()));
             console.log(`Generated ${titles.length} titles, ${uniqueNewTitles.length} are unique enough for recent list.`);
             if (uniqueNewTitles.length < 3 && titles.length >= 5) return titles.slice(0, 15); // Return original if filtering is too aggressive
             if (uniqueNewTitles.length < 5) throw new Error("Se generaron pocos acertijos nuevos o muy repetitivos.");
             return uniqueNewTitles.slice(0, 15);
         }
        function createPollinationsImageUrl(promptText, options = {}) { // Prompt adaptado a ACERTIJOS/LÓGICA
            const defaults = { seed: Math.floor(Math.random() * 10000000), width: 800, height: 600, nologo: true };
            const settings = { ...defaults, ...options };
            const safePromptText = typeof promptText === 'string' && promptText.trim() !== '' ? promptText : "logic puzzle concept";
            // Prompt ENFOCADO en abstracto, conceptual, evitar texto/diagramas directos.
            const enhancedPrompt = `Abstract conceptual image representing logic, problem solving, or mathematical patterns inspired by '${safePromptText}'. Use geometric shapes, interconnected lines, brain activity, lightbulb idea, maze elements, symmetrical patterns. Clean, minimalist, or slightly surreal style. Avoid text and complex diagrams.`;
            const escapedPrompt = encodeURIComponent(enhancedPrompt);
            if (!escapedPrompt) return '';
            // NEGATIVE PROMPT: Evitar texto, formulas, diagramas específicos, personas resolviendo.
            const negativePrompt = "text, words, formulas, equations, numbers, labels, letters, captions, writing, chart, graph, diagram, table, specific puzzle board (like sudoku grid), people, faces, hands writing, realistic photo, cluttered background, school classroom";
            const escapedNegative = encodeURIComponent(negativePrompt);
            let url = `https://image.pollinations.ai/prompt/${escapedPrompt}?seed=${settings.seed}&width=${settings.width}&height=${settings.height}&negative=${escapedNegative}`;
            if (settings.nologo) url += '&nologo=true';
            console.log("Image URL:", url);
            return url;
        }

        // ========== Text Formatting Function ========== (sin cambios)
        function formatExplanationText(rawText) { /* ... */
            if (!rawText) return '';
            let formatted = rawText.trim();
            formatted = formatted.replace(/\\text\{(.*?)\}/g, '$1');
            formatted = formatted.replace(/(\w)_\{?(\d+)\}?/g, '$1<sub>$2</sub>');
            formatted = formatted.replace(/(\w)\^\{?([\d+\-−]+)\}?/g, (match, base, exponent) => { const cleanExponent = exponent.replace('−', '-'); return `${base}<sup>${cleanExponent}</sup>`; });
            formatted = formatted.replace(/\\rightarrow/g, '&rarr;');
            formatted = formatted.replace(/\\\[\s*(.*?)\s*\\\]/g, '<p class="formula" style="text-align: center; font-family: monospace; padding: 0.5em; border: 1px solid #eee; margin: 1em 0;">$1</p>'); // Keep formula styling basic
            formatted = formatted.replace(/^####\s+(.*)$/gm, '<h4>$1</h4>');
            formatted = formatted.replace(/^###\s+(.*)$/gm, '<h3>$1</h3>');
            formatted = formatted.replace(/^##\s+(.*)$/gm, '<h2>$1</h2>');
            formatted = formatted.replace(/^#\s+(.*)$/gm, '<h1>$1</h1>');
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
            const blocks = formatted.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            formatted = blocks.map(block => {
                if (block.startsWith('<h') || block.startsWith('<p class="formula">')) return block;
                let content = block.replace(/\n/g, '<br>');
                return `<p>${content}</p>`;
            }).join('');
            return formatted;
         }

        // ========== MODAL FUNCTIONS ========== (sin cambios estructurales)
        function showModal() { if(!storyModal) return; storyModal.classList.add('active'); document.body.style.overflow = 'hidden'; }
        function hideModal() {
            if(!storyModal || !modalContent) return;
            storyModal.classList.remove('active');
            document.body.style.overflow = '';
            modalContent.scrollTop = 0; // Reset scroll
            console.log("Scroll set to 0 on hideModal");
            resetModalState();
        }
        function resetModalState() {
             if (!modalLoadingIndicator || !modalStoryContentArea || !modalError || !modalTitle || !modalContent) return;
             modalLoadingIndicator.style.display = 'flex';
             modalStoryContentArea.classList.add('content-hidden');
             modalError.classList.add('content-hidden');
             modalTitle.textContent = '';
             modalContent.innerHTML = ''; // Clear previous text and image
             modalErrorMessage.textContent = '';
        }

        // ========== UI & EVENT HANDLERS ==========
        function getRandomElement(arr) { /* ... Sin cambios ... */ if (!arr || arr.length === 0) return null; return arr[Math.floor(Math.random() * arr.length)]; }
        function shuffleArray(array) { /* ... Sin cambios ... */ let ci = array.length, ri; while (ci > 0) { ri = Math.floor(Math.random() * ci); ci--; [array[ci], array[ri]] = [array[ri], array[ci]]; } return array; }
        function createTitleItem(title) { const div = document.createElement('div'); div.className = 'title-item'; div.textContent = title; div.setAttribute('data-title', title); div.addEventListener('click', () => handleTitleClick(title)); return div; }
        function displayTitles(titles) { /* ... Sin cambios ... */
             if (!titleListContainer || !titlesLoading) return;
             const shuffledTitles = shuffleArray([...titles]);
             titleListContainer.innerHTML = '';
             titlesLoading.style.display = 'none';
             if (shuffledTitles.length === 0) { titleListContainer.innerHTML = '<p class="text-gray-500 col-span-full text-center">No hay acertijos disponibles.</p>'; return; }
             shuffledTitles.forEach(title => titleListContainer.appendChild(createTitleItem(title)));
         }
        function appendTitles(newTitles) { /* ... Sin cambios ... */ if (!titleListContainer || !newTitles || newTitles.length === 0) return; newTitles.forEach(title => titleListContainer.appendChild(createTitleItem(title))); }

        // *** MODIFIED: handleTitleClick to append image inside #modal-content (Logic maintained) ***
        async function handleTitleClick(title) {
            resetModalState();
            showModal();
            modalTitle.textContent = title;
            modalContent.innerHTML = '';
            modalError.classList.add('content-hidden');
            modalLoadingIndicator.style.display = 'flex';

            try {
                // 1. Fetch and format text
                const rawExplanationText = await fetchExplanationText(title);
                const formattedExplanation = formatExplanationText(rawExplanationText);

                // 2. Stop loading indicator, display text FIRST
                modalLoadingIndicator.style.display = 'none';
                modalContent.innerHTML = formattedExplanation; // Inject text content
                modalStoryContentArea.classList.remove('content-hidden');

                 // 3. *** RESET SCROLL *** after text content is in and visible
                modalContent.scrollTop = 0;
                console.log("Scroll set to 0 after content visible");

                // 4. Prepare and append image placeholder/spinner WITHIN #modal-content
                const placeholderDiv = document.createElement('div');
                placeholderDiv.className = 'image-placeholder';
                placeholderDiv.innerHTML = `
                    <div class="spinner"></div>
                    <i class="fas fa-image placeholder-icon"></i>
                    <p style="font-size: 0.8em; margin-top: 0.5rem;">Cargando imagen conceptual...</p>
                `;
                modalContent.appendChild(placeholderDiv); // Add placeholder at the end

                // 5. Create and append the actual image element (starts loading)
                const imgElement = document.createElement('img');
                imgElement.className = 'final-image';
                imgElement.alt = `Visualización conceptual para ${title}`;
                imgElement.style.display = 'none'; // Hide until loaded

                imgElement.onload = () => {
                    console.log("Image loaded successfully.");
                    placeholderDiv.remove();
                    imgElement.style.display = 'block';
                };
                imgElement.onerror = () => {
                    console.error("Error loading image for:", title);
                    placeholderDiv.innerHTML = `
                        <i class="fas fa-eye-slash placeholder-icon"></i>
                        <p style="font-size: 0.8em; margin-top: 0.5rem;">No se pudo cargar la imagen.</p>
                    `;
                };

                // Get URL and set src AFTER attaching handlers
                const imageUrl = createPollinationsImageUrl(title);
                 if (imageUrl) {
                     imgElement.src = imageUrl;
                     modalContent.appendChild(imgElement);
                 } else {
                      console.error("Could not create image URL for:", title);
                      placeholderDiv.innerHTML = `
                         <i class="fas fa-exclamation-circle placeholder-icon"></i>
                         <p style="font-size: 0.8em; margin-top: 0.5rem;">Error al generar URL de imagen.</p>
                     `;
                 }

            } catch (error) {
                console.error("Failed display:", error);
                modalLoadingIndicator.style.display = 'none';
                modalErrorMessage.textContent = `Error: ${error.message}`;
                modalError.classList.remove('content-hidden');
                modalStoryContentArea.classList.remove('content-hidden'); // Show area to display error
                modalContent.innerHTML = ''; // Clear partial content on error
            }
        }

        async function handleGenerateMoreTitles() { /* ... Sin cambios estructurales, solo texto ... */
             if (!generateMoreBtn || !generateMoreSpinner || !generateMoreContainer) return;
             generateMoreBtn.disabled = true;
             generateMoreBtn.innerHTML = '<i class="fas fa-sync-alt mr-2 animate-spin"></i> Buscando más...'; // Thematic text
             try {
                 const newTitles = await fetchGeneratedTitles();
                 if (newTitles && newTitles.length > 0) {
                     generateMoreContainer.style.display = 'none';
                     appendTitles(newTitles);
                     // Move button after new titles
                     if (titleListContainer.parentNode) {
                        titleListContainer.insertAdjacentElement('afterend', generateMoreContainer);
                     }
                     generateMoreContainer.style.display = 'block';
                 } else {
                     alert("No se pudieron encontrar más acertijos en este momento."); // Thematic text
                 }
             } catch (error) {
                 console.error("Failed title generation:", error);
                 alert(`Error al generar acertijos: ${error.message}`); // Thematic text
             } finally {
                 generateMoreBtn.disabled = false;
                 generateMoreBtn.innerHTML = '<i class="fas fa-sync-alt mr-2 animate-spin hidden"></i> Generar Más Acertijos'; // Thematic text
             }
         }


        // ========== INITIALIZATION ==========
        function initApp() {
            if (!titleListContainer || !storyModal || !modalCloseBtn || !generateMoreBtn || !titlesLoading) { console.error("Init fail."); document.body.innerHTML = '<p style="color: red; font-size: 1.5em; text-align: center; padding-top: 5em; font-family: sans-serif;">Error Lógico Fatal: No se pudo inicializar la interfaz de desafíos.</p>'; return; } // Thematic error
            modalCloseBtn.addEventListener('click', hideModal);
            generateMoreBtn.addEventListener('click', handleGenerateMoreTitles);
            storyModal.addEventListener('click', (event) => { if (event.target === storyModal) hideModal(); });
            displayTitles(predefinedTitles);
        }
        document.addEventListener('DOMContentLoaded', initApp);
    </script>

</body>
</html>