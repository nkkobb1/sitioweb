<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lenguas y Escrituras de la Historia - Explorador Interactivo</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Fuentes Académicas/Clásicas -->
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- Estilos Adaptados para Lenguas Históricas --- */
        :root {
            --color-primary: #b8860b; /* Ocre/Oro Viejo */
            --color-secondary: #8b4513; /* Marrón Silla */
            --color-tertiary: #006400; /* Verde Oscuro Bosque */
            --color-background: #f5f5dc; /* Pergamino/Beige */
            --color-text: #4b3832; /* Marrón Oscuro Café */
            --color-text-muted: #8f8f8f; /* Gris Medio */
            --color-modal-bg: #fff8dc; /* Crema/Marfil (Modal) */
            --color-border: #d2b48c; /* Tan/Marrón Claro (Bordes) */
            --color-error-bg: #fde8e8; /* Fondo error rosa pálido */
            --color-error-text: #9b2c2c; /* Texto error rojo oscuro */
            --color-error-border: #e57373; /* Borde error rojo claro */

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --border-radius: 4px; /* Bordes suavemente redondeados */
            --transition-normal: all 0.25s ease-in-out;
        }
        body { font-family: 'Lora', serif; background-color: var(--color-background); color: var(--color-text); line-height: 1.75; font-weight: 400; }
        h1, h2, h3, h4, .logo { font-family: 'Merriweather', serif; font-weight: 700; }
        .logo { color: var(--color-secondary); }
        h1.page-title { color: var(--color-secondary); font-weight: 700; }
        h2.section-title { color: var(--color-text); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.6rem; display: inline-block; font-weight: 700; }
        #modal-title { color: var(--color-secondary); font-weight: 700; }
        .navbar { background-color: rgba(245, 245, 220, 0.85); /* Pergamino semi-transparente */ backdrop-filter: blur(5px); box-shadow: var(--shadow-md); position: sticky; top: 0; z-index: 20; border-bottom: 1px solid var(--color-border); }
        /* Estilos Buscador */
        #search-container { margin-bottom: 2.5rem; position: relative; }
        #search-input { width: 100%; padding: 0.8rem 1rem 0.8rem 2.8rem; border: 1px solid var(--color-border); border-radius: var(--border-radius); font-size: 1rem; background-color: #fffefb; /* Blanco hueso */ color: var(--color-text); box-shadow: var(--shadow-sm); transition: var(--transition-normal); font-family: 'Lora'; }
        #search-input::placeholder { color: var(--color-text-muted); font-style: italic; }
        #search-input:focus { border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(184, 134, 11, 0.2); outline: none; background-color: #ffffff; }
        #search-container .fa-search { position: absolute; left: 0.9rem; top: 50%; transform: translateY(-50%); color: var(--color-text-muted); font-size: 1.1rem; transition: color 0.2s ease; }
        #search-input:focus + .fa-search { color: var(--color-primary); }

        #title-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 1rem; }
        .title-item { background-color: var(--color-modal-bg); padding: 1.1rem 0.9rem; border-radius: var(--border-radius); box-shadow: var(--shadow-sm); cursor: pointer; transition: var(--transition-normal); text-align: center; font-weight: 400; color: var(--color-text); border: 1px solid var(--color-border); display: flex; align-items: center; justify-content: center; min-height: 65px; font-family: 'Lora'; font-size: 0.95rem; }
        .title-item:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); border-color: var(--color-primary); color: var(--color-primary); background-color: #fffaf0; /* Floral white hover */ }
        #generate-more-btn { grid-column: 1 / -1; background-color: var(--color-primary); color: white; padding: 0.7rem 1.4rem; border: none; border-radius: var(--border-radius); font-family: 'Merriweather', serif; font-weight: 400; cursor: pointer; transition: var(--transition-normal); margin-top: 2rem; letter-spacing: 0.5px; box-shadow: var(--shadow-sm); }
        #generate-more-btn:hover:not(:disabled) { background-color: #daa520; /* Darker Gold */ box-shadow: var(--shadow-md); }
        #generate-more-btn:disabled { background-color: #cccccc; color: #888888; cursor: not-allowed; opacity: 0.8; box-shadow: none; }
        #generate-more-btn .fa-sync-alt { color: white; }

        #story-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(93, 64, 55, 0.85); /* Overlay Marrón */ display: none; align-items: center; justify-content: center; z-index: 50; padding: 1rem; }
        #story-modal.active { display: flex; }
        .modal-content-wrapper {
            background-color: var(--color-modal-bg);
            border: 1px solid var(--color-primary);
            border-radius: var(--border-radius);
            padding: 1.5rem 2rem;
            max-width: 950px;
            width: 95%;
            max-height: 90vh;
            min-height: 400px;
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
        }
        .modal-close-btn { position: absolute; top: 10px; right: 10px; background: var(--color-border); border: none; border-radius: 50%; width: 36px; height: 36px; font-size: 1.6rem; color: var(--color-text); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition-normal); z-index: 60; }
        .modal-close-btn:hover { background-color: var(--color-primary); color: white; transform: rotate(90deg); box-shadow: var(--shadow-sm); }
        #modal-title { font-size: 1.8rem; text-align: center; margin-bottom: 1.2rem; flex-shrink: 0; padding: 0 1rem; line-height: 1.3; }

        /* Área de Contenido Principal (Texto + Imagen al final) */
        #modal-content-area { flex-grow: 1; min-height: 0; display: flex; flex-direction: column; overflow-y: auto; padding-right: 8px; margin-bottom: 1rem;
            scrollbar-width: thin; scrollbar-color: var(--color-primary) var(--color-border);
        }
        #modal-content-area::-webkit-scrollbar { width: 7px; }
        #modal-content-area::-webkit-scrollbar-track { background: var(--color-border); border-radius: var(--border-radius); }
        #modal-content-area::-webkit-scrollbar-thumb { background-color: var(--color-primary); border-radius: var(--border-radius); border: 1px solid var(--color-modal-bg); }

        #modal-content { padding: 0 5px; }
        #modal-content p:not(:last-child) { margin-bottom: 1.5em; }
        #modal-content strong { color: var(--color-secondary); font-weight: 700; }
        #modal-content em { color: var(--color-tertiary); font-style: italic; }
        #modal-content h1, #modal-content h2, #modal-content h3, #modal-content h4 { font-family: 'Merriweather', serif; margin-top: 2.1em; margin-bottom: 1em; color: var(--color-secondary); border-bottom: 1px solid var(--color-border); padding-bottom: 0.4em; font-weight: 700;}
        #modal-content h1 { font-size: 1.4em; }
        #modal-content h2 { font-size: 1.3em; }
        #modal-content h3 { font-size: 1.15em; color: var(--color-tertiary); }
        #modal-content h4 { font-size: 1.05em; color: var(--color-text-muted); border-bottom: none;}
        /* Estilos imagen final y placeholder */
        #modal-content .final-image { display: block; max-width: 75%; height: auto; margin: 2rem auto 1rem auto; border: 1px solid var(--color-border); border-radius: var(--border-radius); box-shadow: var(--shadow-md); cursor: pointer; transition: transform 0.2s ease; }
        #modal-content .final-image:hover { transform: scale(1.03); }
        #modal-content .image-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 150px; margin: 2rem auto 1rem auto; color: var(--color-text-muted); }
        #modal-content .image-placeholder .spinner { border: 4px solid rgba(210, 180, 140, 0.5); width: 35px; height: 35px; border-radius: 50%; border-left-color: var(--color-primary); animation: spin 1s linear infinite; margin-bottom: 0.5rem; }
        #modal-content .image-placeholder .placeholder-icon { font-size: 2.5rem; }

        /* Chat Section Styles */
        #chat-section { border-top: 1px solid var(--color-border); padding-top: 1rem; margin-top: 1rem; flex-shrink: 0; display: flex; flex-direction: column; max-height: 230px; }
        #chat-history { flex-grow: 1; overflow-y: auto; margin-bottom: 0.8rem; padding: 0.5rem; border: 1px solid var(--color-border); border-radius: var(--border-radius); background-color: #faf0e6; /* Lino */ scroll-behavior: smooth;
            scrollbar-width: thin; scrollbar-color: var(--color-secondary) #e0d6c8;
        }
        #chat-history::-webkit-scrollbar { width: 6px; }
        #chat-history::-webkit-scrollbar-track { background: #e0d6c8; border-radius: var(--border-radius); }
        #chat-history::-webkit-scrollbar-thumb { background-color: var(--color-secondary); border-radius: var(--border-radius); }
        .chat-message { margin-bottom: 0.6rem; padding: 0.5rem 0.8rem; border-radius: var(--border-radius); max-width: 85%; word-wrap: break-word; line-height: 1.5; font-size: 0.95em;}
        .user-message { background-color: var(--color-tertiary); color: white; margin-left: auto; text-align: right; }
        .ai-message { background-color: #eaddca; color: var(--color-text); margin-right: auto; text-align: left; }
        .chat-error { color: var(--color-error-text); font-style: italic; text-align: center; font-size: 0.9em; }
        #chat-input-area { display: flex; gap: 0.5rem; }
        #chat-input { flex-grow: 1; padding: 0.6rem 0.8rem; border: 1px solid var(--color-border); background-color: white; color: var(--color-text); border-radius: var(--border-radius); font-family: 'Lora'; font-size: 0.95rem; }
        #chat-input:focus { outline: none; border-color: var(--color-primary); }
        #chat-send-btn { padding: 0.6rem 1rem; background-color: var(--color-primary); color: white; border: none; border-radius: var(--border-radius); cursor: pointer; transition: background-color 0.2s ease; font-size: 0.9rem; }
        #chat-send-btn:hover:not(:disabled) { background-color: #daa520; }
        #chat-send-btn:disabled { background-color: #cccccc; cursor: not-allowed; }
        #chat-loading { text-align: center; padding: 0.5rem; font-size: 0.9em; color: var(--color-text-muted); display: none; font-style: italic; }
        #chat-loading .fa-spinner { margin-right: 0.5rem; }

        #modal-loading { text-align: center; padding: 3rem 0; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 248, 220, 0.97); /* Crema casi opaco */ display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 55; border-radius: var(--border-radius); }
        .loading-spinner-modal { width: 55px; height: 55px; border: 5px solid var(--color-border); border-top-color: var(--color-primary); border-radius: 50%; animation: spin 1.2s linear infinite; margin: 0 auto 1.5rem auto; }
        #modal-loading p { font-weight: 400; color: var(--color-text); font-size: 1.2rem; font-family: 'Merriweather'; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .error-msg { background-color: var(--color-error-bg); color: var(--color-error-text); padding: 1.1rem; border-radius: var(--border-radius); border: 1px solid var(--color-error-border); margin-top: 1.5rem; text-align: center; flex-shrink: 0; font-weight: 400; font-family: 'Lora'; }
        .error-msg i { margin-right: 0.6rem; }
        .content-hidden { display: none !important; }
        .title-item.hidden { display: none; }

        /* Fullscreen Image Overlay */
        #image-fullscreen-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(75, 56, 50, 0.95); /* Marrón oscuro overlay */ display: none; align-items: center; justify-content: center; z-index: 100; padding: 2rem; cursor: zoom-out; }
        #image-fullscreen-overlay.active { display: flex; }
        #fullscreen-image { max-width: 95%; max-height: 95%; object-fit: contain; border: 2px solid var(--color-primary); box-shadow: var(--shadow-lg); background-color: var(--color-modal-bg); /* Fondo por si imagen es transparente */ }
        #fullscreen-close-btn { position: absolute; top: 20px; right: 25px; background: var(--color-modal-bg); border: 1px solid var(--color-primary); border-radius: 50%; width: 40px; height: 40px; font-size: 1.8rem; color: var(--color-primary); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition-normal); }
        #fullscreen-close-btn:hover { background-color: var(--color-primary); color: white; transform: scale(1.1); }
    </style>
</head>
<body>
     <!-- Header/Navbar -->
     <nav class="navbar mb-10">
         <div class="container mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center">
             <div class="flex items-center text-center mb-3 sm:mb-0">
                 <h1 class="logo text-3xl sm:text-4xl">
                     <i class="fas fa-scroll mr-3 text-yellow-700"></i> <!-- Icono pergamino -->
                     Lingua Historica
                 </h1>
             </div>
             <span class="text-sm text-gray-600 font-serif italic">» Explorador de Lenguas y Escrituras «</span>
         </div>
     </nav>

     <!-- Main content -->
     <main class="container mx-auto px-4 pb-16">
         <!-- Hero section -->
         <section class="mb-12 text-center">
             <h1 class="page-title text-4xl sm:text-5xl mb-5">Tesoros Lingüísticos del Pasado</h1>
             <p class="text-lg text-gray-700 mb-8 max-w-3xl mx-auto">Navega por los anales de la comunicación humana. Descubre lenguas perdidas, escrituras antiguas y familias lingüísticas que moldearon nuestra historia.</p>
         </section>

         <!-- Search Bar -->
         <section id="search-container" class="mb-10 max-w-2xl mx-auto">
             <input type="text" id="search-input" placeholder="Buscar lengua, escritura o concepto...">
             <i class="fas fa-search"></i>
         </section>

         <!-- Title List Container -->
         <section class="mb-10">
             <h2 class="section-title text-2xl sm:text-3xl mb-8 text-center mx-auto">
                 <i class="fas fa-book-open text-green-800 mr-2"></i> <!-- Icono libro abierto -->
                 Índice de Entradas
             </h2>
             <div id="title-list">
                  <p id="titles-loading" class="text-gray-500 col-span-full text-center text-lg font-serif italic">Consultando los archivos antiguos...</p>
                  <!-- Los .title-item se añadirán aquí -->
             </div>
             <p id="no-results" class="text-gray-500 col-span-full text-center text-lg mt-4 hidden font-serif italic">» No se encontraron entradas para los términos de búsqueda «</p>
             <div id="generate-more-container" class="text-center mt-8">
                 <button id="generate-more-btn">
                      <i class="fas fa-sync-alt mr-2 animate-spin hidden"></i>
                     Explorar Más Entradas
                  </button>
             </div>
         </section>

     </main>

     <!-- Explanation Modal -->
     <div id="story-modal">
         <div class="modal-content-wrapper">
             <button class="modal-close-btn" id="modal-close" aria-label="Cerrar">&times;</button>

             <!-- Loading Indicator -->
             <div id="modal-loading">
                 <div class="loading-spinner-modal"></div>
                 <p>Descifrando entrada...</p>
             </div>

             <!-- Content Area Wrapper (Scrollable Text + Fixed Chat below) -->
             <div id="modal-story-content-area" class="content-hidden flex flex-col flex-grow min-h-0">

                 <!-- Scrollable Text Area -->
                 <div id="modal-content-area">
                     <h2 id="modal-title" class="text-xl md:text-2xl font-bold mb-4 text-center flex-shrink-0"></h2>
                     <div id="modal-content">
                         <!-- Explanation text (HTML) goes here -->
                         <!-- La imagen y su placeholder/spinner se añadirán aquí vía JS -->
                     </div>
                 </div>

                 <!-- Chat Section (Fixed at bottom of content area) -->
                 <div id="chat-section">
                     <h3 class="text-sm font-semibold text-gray-600 mb-2 text-center font-serif">Consulta al Escriba sobre este tema:</h3>
                     <div id="chat-history">
                         <!-- Chat messages will appear here -->
                     </div>
                     <div id="chat-loading">
                         <i class="fas fa-spinner fa-spin"></i> Consultando tablillas...
                     </div>
                     <div id="chat-input-area">
                         <input type="text" id="chat-input" placeholder="Haz una pregunta específica...">
                         <button id="chat-send-btn" aria-label="Enviar Mensaje">
                             <i class="fas fa-feather-alt"></i> <!-- Icono pluma -->
                         </button>
                     </div>
                 </div>

                 <!-- Error Display Area -->
                 <div id="modal-error" class="error-msg content-hidden mt-4 flex-shrink-0">
                      <i class="fas fa-exclamation-triangle"></i>
                      <span id="modal-error-message"></span>
                  </div>
             </div>
          </div>
      </div>

      <!-- Fullscreen Image Overlay -->
      <div id="image-fullscreen-overlay">
          <button id="fullscreen-close-btn" aria-label="Cerrar Imagen">&times;</button>
          <img id="fullscreen-image" src="" alt="Imagen Ampliada">
      </div>

      <!-- Footer -->
      <footer class="bg-yellow-50 text-gray-600 py-6 mt-12 border-t border-yellow-200 font-serif">
          <div class="container mx-auto px-4 text-center text-sm">
              <p>Información generada por IA basada en conocimientos de lingüística histórica y filología.</p>
              <p class="mt-1">Para estudios académicos, consulte siempre fuentes especializadas y revisadas por pares.</p>
              <p class="mt-2">© 2024 Lingua Historica Project</p>
          </div>
      </footer>


    <script>
        // ========== CONFIG & DATA ==========
        const predefinedTitles = [
            // Lenguas Antiguas Clave
            "Lengua Sumeria", "Lengua Acadia (Asirio, Babilónico)", "Antiguo Egipcio (Lengua)", "Egipcio Medio", "Egipcio Tardío (Neoegipcio)", "Lengua Copta", "Lengua Hitita", "Lengua Luvita", "Lengua Palaica", "Lengua Hurrita", "Lengua Urartiana", "Lengua Elamita", "Griego Micénico", "Griego Antiguo (General)", "Griego Arcaico", "Griego Clásico (Ático)", "Griego Koiné", "Latín Arcaico", "Latín Clásico", "Latín Vulgar", "Lengua Etrusca", "Lengua Osca", "Lengua Umbra", "Lengua Falistca", "Lengua Fenicia", "Lengua Púnica", "Hebreo Bíblico (Clásico)", "Hebreo Misnaico", "Arameo Antiguo", "Arameo Imperial", "Arameo Bíblico", "Lengua Siríaca", "Lengua Ugarítica", "Lengua Eblaíta", "Antiguo Persa", "Lengua Avesta", "Pehlevi (Persa Medio)", "Lengua Parta", "Lengua Sogdiana", "Lengua Bactriana", "Sánscrito Védico", "Sánscrito Clásico", "Lenguas Prácritas", "Lengua Pali", "Chino Antiguo", "Chino Medio", "Antiguo Irlandés", "Galés Antiguo", "Lengua Gala", "Lengua Celtíbera", "Lengua Gótica", "Antiguo Nórdico", "Antiguo Inglés (Anglosajón)", "Antiguo Sajón", "Antiguo Alto Alemán", "Antiguo Eslavo Eclesiástico", "Lengua Proto-Eslava", "Lengua Tocaria (A y B)", "Lengua Frigia", "Lengua Tracia", "Lengua Dacia", "Lengua Iliria", "Lengua Mesapia", "Lengua Venética", "Lengua Ligur (Antigua)", "Lengua Ibérica (No indoeuropea)", "Lengua Tartésica", "Lengua Aquitana (Proto-Vasco?)", "Lengua Minoica (Lineal A?)",
            // Escrituras Antiguas Clave
            "Escritura Cuneiforme (General)", "Cuneiforme Sumerio", "Cuneiforme Acadio", "Cuneiforme Ugarítico", "Cuneiforme Persa Antiguo", "Jeroglíficos Egipcios", "Escritura Hierática", "Escritura Demótica", "Escritura Copta", "Escritura Proto-Sinaítica", "Alfabeto Fenicio", "Alfabeto Paleo-Hebreo", "Alfabeto Arameo", "Alfabeto Hebreo Cuadrado", "Alfabeto Siríaco (Estrangelo, Serto, Madnhaya)", "Alfabeto Nabateo", "Alfabeto Sudarábico Antiguo", "Alfabeto Ge'ez (Etíope)", "Alfabeto Griego", "Alfabeto Latino", "Alfabeto Etrusco", "Alfabeto Rúnico (Futhark Antiguo, Futhark Joven, Futhorc)", "Escritura Ogham", "Escritura Ibérica (Nororiental, Suroriental)", "Escritura Celtíbera", "Lineal B (Griego Micénico)", "Lineal A (Minoico - No descifrado)", "Disco de Festos (No descifrado)", "Escritura Chipriota Silábica", "Escritura del Indo (No descifrada)", "Caracteres Chinos (Huesos Oraculares)", "Caracteres Chinos (Bronce - Jinwen)", "Caracteres Chinos (Sello Mayor y Menor)", "Escritura Clerical (Lishu)", "Escritura Regular (Kaishu)", "Escritura Brahmi", "Escritura Karosthi", "Alfabeto Devanagari", "Alfabeto Tibetano", "Escritura Tamil Brahmi", "Escritura Pallava", "Escritura Gupta", "Escritura Nagari", "Escritura Phagspa", "Escritura Sogdiana", "Escritura Uigur Antigua", "Escritura Mongola Tradicional", "Escritura Manchú", "Glagolítico", "Alfabeto Cirílico Temprano", "Escritura Maya (Glifos)", "Escritura Azteca (Pictográfica/Ideográfica)", "Escritura Zapoteca", "Escritura Epi-Olmeca", "Quipu Andino (Sistema de Nudos)", "Escritura Meroítica", "Escritura Rongorongo (Isla de Pascua - No descifrada)",
            // Familias Lingüísticas Importantes
            "Familia Indoeuropea (General)", "Rama Anatolia (Hitita, Luvita)", "Rama Helénica (Griego)", "Rama Itálica (Latín, Osco-Umbro)", "Rama Celta (Gaélico, Britónico)", "Rama Germánica (Gótico, Nórdico, Occidental)", "Rama Balto-Eslava", "Rama Báltica (Lituano, Letón, Prusiano Ant.)", "Rama Eslava (Oriental, Occidental, Meridional)", "Rama Indo-Irania", "Rama India (Indo-aria: Sánscrito, Hindi, Bengalí...)", "Rama Irania (Persa, Pastún, Kurdo...)", "Rama Armenia", "Rama Albanesa", "Rama Tocaria", "Familia Afroasiática (General)", "Rama Semítica (Acadio, Hebreo, Arameo, Árabe...)", "Rama Egipcia", "Rama Bereber", "Rama Cushítica (Somalí, Oromo...)", "Rama Chádica (Hausa...)", "Rama Omótica", "Familia Sino-Tibetan (General)", "Rama Sinítica (Chino)", "Rama Tibeto-Birmana", "Familia Níger-Congo (General)", "Lenguas Bantúes", "Familia Austronesia (General)", "Malayo-Polinesio", "Familia Dravídica (Tamil, Telugu, Canarés...)", "Familia Uralica (Finés, Húngaro, Estonio...)", "Familia Altaica (Controvertida: Túrquico, Mongólico, Tungúsico)", "Familia Na-Dené (Navajo, Apache...)", "Familia Uto-Azteca (Náhuatl, Hopi...)", "Familia Maya", "Familia Quechua", "Familia Tupí-Guaraní", "Familia Pama-Nyungan (Australia)", "Lenguas Caucásicas (Kartveliano, Noroccidental, Nororiental)", "Lenguas Paleo-Siberianas (Grupo Geográfico)", "Lenguas Joisanas (Clics)",
            // Conceptos de Lingüística Histórica
            "Lingüística Histórica (Definición)", "Lingüística Comparada", "Método Comparativo", "Reconstrucción Lingüística", "Proto-Lengua (Ej: Proto-Indo-European)", "Cognados (Palabras emparentadas)", "Leyes Fonéticas (Ley de Grimm, Ley de Verner)", "Cambio Fonético", "Cambio Semántico", "Cambio Gramatical (Gramaticalización)", "Analogía Lingüística", "Préstamo Lingüístico (Loanword)", "Sustrato, Superestrato, Adstrato", "Isoglosa", "Dialectología Histórica", "Datación Glotocronológica (Controvertida)", "Árbol Genealógico Lingüístico", "Teoría de las Ondas (Wellentheorie)", "Lengua Aislada (Ej: Vasco, Coreano?)", "Lengua Criolla (Creole)", "Lengua Pidgin", "Muerte de Lenguas", "Revitalización Lingüística", "Desciframiento de Escrituras", "Piedra de Rosetta", "Inscripción de Behistún", "Paleografía (Estudio de escrituras antiguas)", "Epigrafía (Estudio de inscripciones)", "Filología", "Manuscritos Antiguos (Ej: Rollos del Mar Muerto)", "Códices Mesoamericanos", "Historia de la Escritura", "Tipos de Sistemas de Escritura (Alfabético, Silábico, Logográfico)", "Origen del Alfabeto", "Diglosia Histórica", "Koinéización", "Estandarización Lingüística", "El Gran Cambio Vocálico (Inglés)", "Rotacismo (Latín)", "Palatalización", "Nasalización",
            // Etapas Históricas Específicas
            "Inglés Antiguo (Anglosajón)", "Inglés Medio", "Inglés Moderno Temprano", "Francés Antiguo", "Francés Medio", "Alto Alemán Antiguo", "Alto Alemán Medio", "Bajo Alemán Medio (Lengua Hanseática)", "Castellano Antiguo (Medieval)", "Gallego-Portugués Medieval", "Catalán Antiguo", "Rumano Antiguo", "Irlandés Antiguo", "Irlandés Medio", "Sánscrito Védico vs Clásico", "Chino Arcaico vs Medio", "Japonés Antiguo", "Japonés Medio", "Árabe Clásico", "Turco Otomano Antiguo", "Nórdico Rúnico vs Nórdico Antiguo",
            // Temas Misceláneos
            "Lenguas Indígenas de América (Visión Histórica)", "Lenguas Aborígenes de Australia (Visión Histórica)", "Influencia del Latín en Lenguas Europeas", "Influencia del Árabe en el Español", "Influencia del Sánscrito en Lenguas del Sudeste Asiático", "El Manuscrito Voynich (Indescifrado)", "La Escritura del Indo (Indescifrada)", "Lineal A (Indescifrado)", "El Disco de Festos (Indescifrado)", "Rongorongo (Indescifrado)", "La Lengua Ibérica (Indescifrada)", "La Lengua Etrusca (Parcialmente Comprendida)", "Lenguas Artificiales Históricas (Volapük, Esperanto - contexto histórico)"
        ];
        const historicalLanguageThemes = [
            "lenguas indoeuropeas", "lenguas semíticas", "lenguas antiguas de Mesopotamia", "lengua y escritura egipcias", "lenguas clásicas (griego y latín)", "escrituras antiguas", "desciframiento de escrituras", "familias lingüísticas", "proto-lenguas", "cambio lingüístico", "lingüística histórica", "lenguas muertas", "escritura cuneiforme", "jeroglíficos", "alfabetos antiguos", "lenguas de la India antigua", "lenguas de China antigua", "lenguas precolombinas", "lenguas germánicas antiguas", "lenguas celtas antiguas", "lenguas eslavas antiguas", "lenguas romances (evolución)", "escrituras no descifradas"
        ];
        const textApiConfig = { // Para descripción principal
            model: "mistral",
            systemPrompt: "Eres un erudito lingüista e historiador, especializado en filología comparada y la historia de las lenguas y sistemas de escritura del mundo. Tu tarea es proporcionar una descripción detallada, académica pero accesible, sobre la lengua, escritura, familia lingüística o concepto histórico-lingüístico indicado. Cubre aspectos como: Origen y período histórico, distribución geográfica (original y expansión/declive), características estructurales clave (fonología, gramática básica, léxico notable), sistema de escritura asociado (si aplica, describiendo su tipo y características), relación con otras lenguas/familias, corpus textual importante o descubrimientos clave (inscripciones, manuscritos), importancia cultural e histórica, y estado actual (extinta, viva, descendientes). Utiliza terminología lingüística apropiada explicándola brevemente si es necesario. El objetivo es una exposición completa de aproximadamente 1200-1300 palabras. Basa tu descripción únicamente en la siguiente entrada:",
            timeoutSeconds: 150
        };
        const chatApiConfig = { // Config base para chat, system prompt se sobreescribe
            model: "mistral-tiny", // Modelo rápido para chat
             systemPrompt: "Actúa como un asistente de investigación especializado únicamente en el tema lingüístico o de escritura que se está mostrando. Responde preguntas de seguimiento sobre sus detalles, historia, estructura o relaciones mencionadas en la descripción principal. Sé preciso, conciso y mantente estrictamente dentro del tema actual.",
            timeoutSeconds: 45 // Menor timeout para chat
        };
        const titleGenerationConfig = {
            model: "mistral",
            systemPrompt: "Actúa como un generador de ideas conciso para una enciclopedia de lingüística histórica. Genera exactamente 15 nombres de lenguas históricas, escrituras antiguas, familias lingüísticas, o conceptos clave en la historia de las lenguas. Devuelve *solo* la lista de ítems, uno por línea. No incluyas números, guiones, introducciones ni despedidas.",
            timeoutSeconds: 40
        };

        // ========== DOM ELEMENTS ==========
        const searchInput = document.getElementById('search-input');
        const titleListContainer = document.getElementById('title-list');
        const titlesLoading = document.getElementById('titles-loading');
        const noResultsMsg = document.getElementById('no-results');
        const generateMoreContainer = document.getElementById('generate-more-container');
        const generateMoreBtn = document.getElementById('generate-more-btn');
        const generateMoreSpinner = generateMoreBtn.querySelector('i');
        const storyModal = document.getElementById('story-modal');
        const modalCloseBtn = document.getElementById('modal-close');
        const modalLoadingIndicator = document.getElementById('modal-loading');
        const modalStoryContentArea = document.getElementById('modal-story-content-area');
        const modalTextArea = document.getElementById('modal-content-area');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalError = document.getElementById('modal-error');
        const modalErrorMessage = document.getElementById('modal-error-message');
        // Chat Elements
        const chatSection = document.getElementById('chat-section');
        const chatHistory = document.getElementById('chat-history');
        const chatInput = document.getElementById('chat-input');
        const chatSendBtn = document.getElementById('chat-send-btn');
        const chatLoadingIndicator = document.getElementById('chat-loading');
        // Fullscreen Image Elements
        const imageFullscreenOverlay = document.getElementById('image-fullscreen-overlay');
        const fullscreenImage = document.getElementById('fullscreen-image');
        const fullscreenCloseBtn = document.getElementById('fullscreen-close-btn');

        // ========== State Variables ==========
        let currentLanguageTitle = null; // Contexto para el chat

        // ========== API FUNCTIONS ==========
        async function fetchTextFromApi(prompt, config, isChat = false) {
             const encodedPrompt = encodeURIComponent(prompt);
             const systemPromptToUse = isChat && currentLanguageTitle
                 ? `Eres un asistente de investigación especializado únicamente en el tema lingüístico '${currentLanguageTitle}'. Responde preguntas de seguimiento sobre sus detalles (historia, estructura, escritura, etc.) mencionados en la descripción principal. Sé preciso, conciso y cíñete estrictamente a este tema.`
                 : config.systemPrompt;
             const encodedSystem = encodeURIComponent(systemPromptToUse);

             const params = new URLSearchParams({ model: config.model, system: encodedSystem });
             if (config.seed && !isChat) params.append('seed', config.seed);
             const url = `https://text.pollinations.ai/${encodedPrompt}?${params.toString()}`;
             console.log(`Fetching text from API (${config.model}, Chat: ${isChat}): ${url.substring(0, 200)}...`);

             const controller = new AbortController();
             const timeoutId = setTimeout(() => controller.abort(), config.timeoutSeconds * 1000);

             try {
                 const response = await fetch(url, { signal: controller.signal });
                 clearTimeout(timeoutId);

                 if (!response.ok) {
                     // *** MENSAJE DE ERROR AMIGABLE ***
                     throw new Error(`(Error ${response.status}) Nuestros escribas parecen estar desbordados en este momento. Por favor, inténtalo de nuevo en unos instantes.`);
                 }
                 const text = await response.text();
                 if (!text || text.trim().length === 0) {
                     throw new Error("La respuesta de la IA llegó vacía. Intenta reformular tu consulta.");
                 }
                 console.log(`API Response received (${text.length} chars)`);
                 return text;
             } catch (error) {
                 clearTimeout(timeoutId);
                 console.error("API Fetch Error:", error);
                 if (error.name === 'AbortError') {
                     // *** MENSAJE DE ERROR AMIGABLE ***
                     throw new Error(`La conexión con los archivos es inestable (>${config.timeoutSeconds}s). Revisa tu conexión o intenta más tarde.`);
                 }
                 throw new Error(error.message || "Ocurrió un error inesperado consultando los archivos.");
             }
        }
        async function fetchExplanationText(conceptTitle) {
            return fetchTextFromApi(conceptTitle, textApiConfig, false);
        }
        async function fetchChatResponse(userQuery) {
            if (!currentLanguageTitle) throw new Error("Error interno: No se ha establecido el contexto lingüístico para la consulta.");
            return fetchTextFromApi(userQuery, chatApiConfig, true); // true indica que es chat
        }
        async function fetchGeneratedTitles() {
            const randomTheme = getRandomElement(historicalLanguageThemes) || "lingüística histórica general";
            const specificPrompt = `Genera 15 nombres/conceptos relacionados con ${randomTheme}`;
            return fetchTextFromApi(specificPrompt, titleGenerationConfig, false)
                 .then(text => {
                     const titles = text.split('\n').map(line => line.replace(/^[-\d.\s*]+/, '').trim()).filter(line => line.length > 3 && line.length < 150);
                     if (titles.length < 5) throw new Error("La IA no pudo generar suficientes entradas nuevas.");
                     return titles.slice(0, 15);
                 });
        }
        function createPollinationsImageUrl(promptText, options = {}) {
             const defaults = { seed: Math.floor(Math.random() * 10000000), width: 800, height: 600, nologo: true };
             const settings = { ...defaults, ...options };
             const safePromptText = typeof promptText === 'string' && promptText.trim() !== '' ? promptText : "historical language or script concept";
             // Prompt enfocado en lo visual/conceptual, no texto literal
             const enhancedPrompt = `Conceptual artwork representing '${safePromptText}'. Evoke historical context, manuscripts, inscriptions, archaeological artifacts, or cultural elements associated with it. Avoid text, labels, letters (unless artistically representing the script itself). Atmospheric, scholarly feel, muted colors, perhaps sepia tones or parchment texture.`;
             const escapedPrompt = encodeURIComponent(enhancedPrompt);
             if (!escapedPrompt) return '';
             const negativePrompt = "text, words, labels, letters, title, caption, diagram, chart, graph, map, flag, modern elements, clear photograph, UI, menu, button, watermark, signature, multiple images, collage";
             const escapedNegative = encodeURIComponent(negativePrompt);
             let url = `https://image.pollinations.ai/prompt/${escapedPrompt}?seed=${settings.seed}&width=${settings.width}&height=${settings.height}&negative=${escapedNegative}`;
             if (settings.nologo) url += '&nologo=true';
             console.log("Image URL:", url);
             return url;
         }

        // ========== Text Formatting Function ========== (sin cambios)
        function formatExplanationText(rawText) { /* ... */
            if (!rawText) return '';
            let formatted = rawText.trim();
            formatted = formatted.replace(/\\text\{(.*?)\}/g, '$1');
            formatted = formatted.replace(/(\w)_\{?(\d+)\}?/g, '$1<sub>$2</sub>');
            formatted = formatted.replace(/(\w)\^\{?([\d+\-−]+)\}?/g, (match, base, exponent) => { const cleanExponent = exponent.replace('−', '-'); return `${base}<sup>${cleanExponent}</sup>`; });
            formatted = formatted.replace(/\\rightarrow/g, '&rarr;');
            formatted = formatted.replace(/\\\[\s*(.*?)\s*\\\]/g, '<p class="formula" style="text-align:center; font-style:italic; margin: 1em 0;">$1</p>'); // Style formulas if any appear
            formatted = formatted.replace(/^####\s+(.*)$/gm, '<h4>$1</h4>');
            formatted = formatted.replace(/^###\s+(.*)$/gm, '<h3>$1</h3>');
            formatted = formatted.replace(/^##\s+(.*)$/gm, '<h2>$1</h2>');
            formatted = formatted.replace(/^#\s+(.*)$/gm, '<h1>$1</h1>');
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
            const blocks = formatted.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            formatted = blocks.map(block => {
                if (block.startsWith('<h') || block.startsWith('<p class="formula">')) return block;
                let content = block.replace(/\n/g, ' ');
                return `<p>${content}</p>`;
            }).join('');
            return formatted;
         }

        // ========== MODAL FUNCTIONS ==========
        function showModal() { storyModal.classList.add('active'); document.body.style.overflow = 'hidden'; }
        function hideModal() {
            storyModal.classList.remove('active');
            if (!imageFullscreenOverlay.classList.contains('active')) {
                document.body.style.overflow = '';
            }
            modalTextArea.scrollTop = 0;
            console.log("Scroll set to 0 on hideModal");
            resetModalState();
        }
        function resetModalState() {
             modalLoadingIndicator.style.display = 'flex';
             modalStoryContentArea.classList.add('content-hidden');
             modalError.classList.add('content-hidden');
             modalTitle.textContent = '';
             modalContent.innerHTML = '';
             modalErrorMessage.textContent = '';
             // Reset Chat
             chatHistory.innerHTML = '';
             chatInput.value = '';
             chatLoadingIndicator.style.display = 'none';
             chatSendBtn.disabled = false;
             currentLanguageTitle = null; // Limpia contexto
             hideFullscreenImage(); // Asegura que la imagen ampliada se cierre
        }

        // ========== FULLSCREEN IMAGE FUNCTIONS ==========
        function showFullscreenImage(imgSrc) {
            if (!imageFullscreenOverlay || !fullscreenImage) return;
            fullscreenImage.src = imgSrc;
            imageFullscreenOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        function hideFullscreenImage() {
            if (!imageFullscreenOverlay) return;
            imageFullscreenOverlay.classList.remove('active');
            if (!storyModal.classList.contains('active')) {
                 document.body.style.overflow = '';
            }
            fullscreenImage.src = '';
        }

        // ========== CHAT FUNCTIONS ==========
        function addChatMessage(message, sender) {
            const msgDiv = document.createElement('div');
            msgDiv.classList.add('chat-message', sender === 'user' ? 'user-message' : 'ai-message');
            message = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            message = message.replace(/\*(.*?)\*/g, '<em>$1</em>');
            msgDiv.innerHTML = message;
            chatHistory.appendChild(msgDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }
        function addChatError(message) {
             const errorDiv = document.createElement('div');
             errorDiv.classList.add('chat-error');
             errorDiv.textContent = `Error del Escriba: ${message}`; // Themed error
             chatHistory.appendChild(errorDiv);
             chatHistory.scrollTop = chatHistory.scrollHeight;
        }
        async function handleSendMessage() {
            const userQuery = chatInput.value.trim();
            if (!userQuery || chatSendBtn.disabled || !currentLanguageTitle) return;

            addChatMessage(userQuery, 'user');
            chatInput.value = '';
            chatSendBtn.disabled = true;
            chatLoadingIndicator.style.display = 'block';

            try {
                const aiResponse = await fetchChatResponse(userQuery);
                addChatMessage(aiResponse, 'ai');
            } catch (error) {
                console.error("Chat Error:", error);
                addChatError(error.message);
            } finally {
                chatLoadingIndicator.style.display = 'none';
                chatSendBtn.disabled = false;
                chatInput.focus();
            }
        }

        // ========== UI & EVENT HANDLERS ==========
        function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function shuffleArray(array) { let ci=array.length,ri;while(ci>0){ri=Math.floor(Math.random()*ci);ci--;[array[ci],array[ri]]=[array[ri],array[ci]];} return array; }
        function createTitleItem(title) { const div=document.createElement('div'); div.className='title-item'; div.textContent=title; div.setAttribute('data-title', title); div.addEventListener('click', () => handleTitleClick(title)); return div; }
        function displayTitles(titles) {
             if (!titleListContainer || !titlesLoading) return;
             // Ordenar alfabéticamente tiene sentido aquí
             const sortedTitles = titles.sort((a, b) => a.localeCompare(b, 'es', { sensitivity: 'base' }));
             titleListContainer.innerHTML = '';
             titlesLoading.style.display = 'none';
             if (sortedTitles.length === 0) { titleListContainer.innerHTML = '<p class="text-gray-500 col-span-full text-center font-serif italic">» No hay entradas disponibles en los archivos «</p>'; return; }
             sortedTitles.forEach(title => titleListContainer.appendChild(createTitleItem(title)));
         }
        function appendTitles(newTitles) {
             if (!titleListContainer || !newTitles || newTitles.length === 0) return;
             const existingTitles = new Set(Array.from(titleListContainer.querySelectorAll('.title-item')).map(item => item.dataset.title));
             newTitles.forEach(title => { if (!existingTitles.has(title)) { titleListContainer.appendChild(createTitleItem(title)); } });
             // Reordenar toda la lista o simplemente añadir al final y filtrar? Añadir y filtrar es más simple.
             filterTitles(searchInput.value);
         }

        async function handleTitleClick(title) {
            resetModalState();
            showModal();
            modalTitle.textContent = title;
            currentLanguageTitle = title; // *** SET CHAT CONTEXT ***
            modalContent.innerHTML = '';
            chatHistory.innerHTML = '';
            modalError.classList.add('content-hidden');
            modalLoadingIndicator.style.display = 'flex';

            try {
                const rawExplanationText = await fetchExplanationText(title);
                const formattedExplanation = formatExplanationText(rawExplanationText);

                modalLoadingIndicator.style.display = 'none';
                modalContent.innerHTML = formattedExplanation;
                modalStoryContentArea.classList.remove('content-hidden');

                modalTextArea.scrollTop = 0;
                console.log("Scroll set to 0 after content visible");

                const placeholderDiv = document.createElement('div');
                placeholderDiv.className = 'image-placeholder';
                placeholderDiv.innerHTML = `
                    <div class="spinner"></div>
                    <i class="fas fa-palette placeholder-icon"></i> <!-- Icono paleta/arte -->
                    <p style="font-size: 0.8em; margin-top: 0.5rem; font-style: italic;">Evocando representación visual...</p>
                `;
                modalContent.appendChild(placeholderDiv);

                const imgElement = document.createElement('img');
                imgElement.className = 'final-image';
                imgElement.alt = `Representación conceptual de ${title}`;
                imgElement.style.display = 'none';

                imgElement.onload = () => {
                    console.log("Image loaded successfully.");
                    placeholderDiv.remove();
                    imgElement.style.display = 'block';
                    imgElement.addEventListener('click', () => showFullscreenImage(imgElement.src));
                };
                imgElement.onerror = () => {
                    console.error("Error loading image for:", title);
                    placeholderDiv.innerHTML = `<i class="fas fa-image-slash placeholder-icon"></i><p style="font-size:0.8em;margin-top:0.5rem; font-style: italic;">Visualización no disponible.</p>`;
                };

                const imageUrl = createPollinationsImageUrl(title);
                if (imageUrl) {
                    imgElement.src = imageUrl;
                    modalContent.appendChild(imgElement);
                } else {
                     console.error("Could not create image URL for:", title);
                     placeholderDiv.innerHTML = `<i class="fas fa-exclamation-circle placeholder-icon"></i><p style="font-size:0.8em;margin-top:0.5rem; font-style: italic;">Error generando URL de imagen.</p>`;
                }

            } catch (error) {
                console.error("Failed display:", error);
                modalLoadingIndicator.style.display = 'none';
                // *** FRIENDLY ERROR MESSAGE ***
                modalErrorMessage.textContent = error.message || "Error desconocido al recuperar la entrada.";
                modalError.classList.remove('content-hidden');
                modalStoryContentArea.classList.remove('content-hidden');
                modalContent.innerHTML = '';
                chatSection.classList.add('content-hidden');
            }
        }

        async function handleGenerateMoreTitles() {
             if (!generateMoreBtn || !generateMoreSpinner || !generateMoreContainer) return;
             generateMoreBtn.disabled = true;
             generateMoreBtn.innerHTML = '<i class="fas fa-sync-alt mr-2 animate-spin"></i> Buscando en los archivos...';
             try {
                 const newTitles = await fetchGeneratedTitles();
                 if (newTitles && newTitles.length > 0) { appendTitles(newTitles); }
                 else { alert("No se encontraron más entradas relevantes en este momento."); }
             } catch (error) {
                 console.error("Failed title generation:", error);
                 // *** FRIENDLY ERROR MESSAGE ***
                 alert(`Error al buscar nuevas entradas: ${error.message}`);
             } finally {
                 generateMoreBtn.disabled = false;
                 generateMoreBtn.innerHTML = '<i class="fas fa-sync-alt mr-2 animate-spin hidden"></i> Explorar Más Entradas';
             }
         }

         // Search Filter Function (con normalización para tildes)
         function filterTitles(searchTerm) {
             const term = searchTerm.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim();
             const titleItems = titleListContainer.querySelectorAll('.title-item');
             let visibleCount = 0;
             titleItems.forEach(item => {
                 const titleText = item.dataset.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                 const isVisible = titleText.includes(term);
                 item.classList.toggle('hidden', !isVisible);
                 if (isVisible) visibleCount++;
             });
             noResultsMsg.classList.toggle('hidden', visibleCount > 0 || titleItems.length === 0); // Oculta si hay resultados o si la lista está vacía
         }

        // ========== INITIALIZATION ==========
        function initApp() {
            if (!titleListContainer || !storyModal || !modalCloseBtn || !generateMoreBtn || !titlesLoading || !searchInput || !noResultsMsg || !chatInput || !chatSendBtn || !imageFullscreenOverlay || !fullscreenCloseBtn) {
                console.error("Initialization failed: Missing essential page elements.");
                document.body.innerHTML = '<p style="color: darkred; font-size: 1.5em; text-align: center; padding-top: 3em; font-family: serif;">Error Crítico: No se pudieron cargar los componentes de la interfaz.</p>';
                return;
             }
            // Event listeners
            modalCloseBtn.addEventListener('click', hideModal);
            storyModal.addEventListener('click', (event) => { if (event.target === storyModal) hideModal(); });
            generateMoreBtn.addEventListener('click', handleGenerateMoreTitles);
            searchInput.addEventListener('input', (event) => filterTitles(event.target.value));
            searchInput.addEventListener('keypress', (event) => { if (event.key === 'Enter') event.preventDefault(); });
            chatSendBtn.addEventListener('click', handleSendMessage);
            chatInput.addEventListener('keypress', (event) => { if (event.key === 'Enter') handleSendMessage(); });
            imageFullscreenOverlay.addEventListener('click', hideFullscreenImage);
            fullscreenCloseBtn.addEventListener('click', (event) => { event.stopPropagation(); hideFullscreenImage(); });

            // Initial display
            displayTitles(predefinedTitles);
            noResultsMsg.classList.add('hidden');
        }
        document.addEventListener('DOMContentLoaded', initApp);
    </script>

</body>
</html>